# Java面试收集整理--Redis专题

## 1. 缓存雪崩、缓存穿透、缓存击穿

1. 缓存雪崩、缓存穿透、缓存击穿

   > 1. 缓存雪崩、缓存穿透、缓存击穿的介绍
   >
   >     * 缓存雪崩：
   >
   >        指的是缓存同一时间大面积的失效，后面的请求都会直接落在数据库上，造成数据库短时间承受大量的请求
   >        
   >        例如Redis重启时、第一次启动服务，都可能导致缓存雪崩
   >        
   >     * 缓存穿透
   >     
   >        指的是缓存中和数据库中都没有数据，导致所有的请求都落在数据库上，导致数据库短时间承受大量的请求
   >        
   >        例如Redis遭受攻击时
   >        
   >     * 缓存击穿
   >     
   >        指的是缓存中没有，但是数据库中有的数据，由于并发用户很大，用户去缓存中读取不到数据，就去数据库读取，造成数据库压力瞬间提升
   >        
   >        一般是数据库数据在缓存中过期导致
   >        
   >        
   >
   > 2. 缓存雪崩、缓存穿透、缓存击穿解决方案
   > 
   >      * 缓存雪崩解决方案：
   >      
   >         方案1：缓存数据的过期时间设置随机，防止同一时间数据过期现象
   >         
   >         方案2：给每个缓存数据都增加一个缓存标记，记录缓存是否失效，如果缓存标记失效，则更新数据缓存
   >         
   >         方案3：缓存预热。针对Redis重启的情况，先将部分数据放入Redis，然后再重启
   >         
   >         方案4：使用互斥锁
   >         
   >      * 缓存穿透解决方案
   >      
   >         方案1：接口层增加用户校验，如用户权限校验、id基础校验
   >         
   >         方案2：如果发现有缓存中没有并且数据库也没有的值，直接key-value设置为key-null，并且将缓存有效时间设置短一些
   >         
   >         方案3：使用布隆过滤器，将所有可能存在的数据哈希到一个足够大的bitmap中，一个一定不存在的数据，必定会被该bitmap拦截。
   >         
   >      * 缓存击穿解决方案
   >      
   >         方案1：对热点数据设置永不过期
   >         
   >         方案2：加互斥锁
   >         
## 2. Redis的过期键的删除策略
2. Redis的过期键的删除策略
    > 1. 什么是Redis中过期键的删除策略
    >
    >    Redis中我们可以设置key-value中key的过期时间，Redis的过期键删除策略就是如果Redis中key过期了，Redis如何处理
    >    
    > 2. 删除策略一共有2种
    >
    >     1. 惰性过期
    >     
    >         1. 介绍
    >         
    >            只有当访问一个key时，才会判断该key是否过期，如果过期则清除。
    >            
    >         2. 好处与不足
    >         
    >            惰性过期好处是最大化的节省了CPU的资源
    >            
    >            不好的地方是对内存很不友好，极端情况下可能会造成大量的过期key没有再次访问，从而不被删除占用大量内存的情况
    >        
    >     2. 定时过期
    >     
    >         1. 介绍
    >         
    >            每隔一段时间，会扫描一定数量的Redis的expires字典中数据的key，清除其中过期的key
    >            
    >             * expires字典：Redis中所有设置了过期时间的key，它们对应的value都会放入该字典中。
    >             
    >         2. 好处
    >         
    >            通过调整定时扫描时间和每次扫描的数量，可以做到使得CPU消耗和内存资源达到平衡的效果
    >            
    > 3. Redis同时使用这两种策略处理过期key
    > 
## 3. Redis线程模型，单线程为什么这么快
3. Redis线程模型，单线程为什么这么快
    > 1. Redis线程模型
    > 
    >    Redis基于Reactor模式开发了网络事件处理器，该处理器叫做文件事件处理器。该文件处理器是单线程的，并且使用了IO多路复用机制
    >    
    >    文件事件处理器包含了4个部分：多个Socket，IO多路复用程序，文件事件分派器、事件处理器
    >    
    > 2. 为什么Redis快
    > 
    >    1. 基于内存
    >    
    >    2. 核心是NIO的多路IO复用
    >    
    >    3. 单线程避免了线程切换带来的消耗
    >    
## 4. 简述Redis事务的实现
4. 简述Redis事务的实现
    > 1. 